from typing import List
from math import sqrt

# Standard DP
class Solution:
    def canCross(self, stones: List[int]) -> bool:
        N = len(stones)
        indexes = {v: i for i, v in enumerate(stones)}
        dp = [[False for j in range(N+2)] for i in range(N)]
        dp[0][1] = True
        for i in range(1, N): # stone
            pos = stones[i]
            for j in range(1, i+2): # jump step
                for k in [j-1, j, j+1]:
                    if pos-k in indexes:
                        dp[i][j] |= dp[indexes[pos-k]][k]
        return any(dp[-1])

# Speed up with a little trick: only consider those jumps which are possible
class Solution2:
    def canCross(self, stones):
        if stones[1] != 1:
            return False
        d = {x: set() for x in stones}
        d[1].add(1)
        for x in stones[:-1]:
            for j in d[x]:
                for k in range(j-1, j+2):
                    if k > 0 and x+k in d:
                        d[x+k].add(k)
        return bool(d[stones[-1]])

s = Solution()
stones = [0,1,3,5,6,8,12,17]
# stones = [0,1006644,1077913,1342973,1895715,2102046,2608600,2642306,3182522,3940674,5803233,5929099,7010286,8432541,9325578,9446770,9959613,11153304,11912894,12298843,12495971,12951435,13954065,14259911,14337786,15017793,15727636,17076846,18087443,18091005,18940898,20366466,20605596,21494789,22494649,22607371,23093579,23132594,24573223,24978627,25883613,26008099,26008410,26234982,26596413,28001049,28145695,29513486,30541844,30659078,31163315,32708677,32785089,33474143,33516954,33558081,34183807,34191573,35001624,35898624,36080643,36305806,36797150,37556563,38226080,38246220,38410694,41808052,43093851,43198887,44146728,44498957,45707222,45913789,46313675,47481553,47810305,50203872,50295775,51014544,51133457,51632114,51757154,51855870,52538660,53672446,53692420,54789722,55054129,55498197,55564235,56572983,56607816,56901575,57409927,57867681,58573982,59786202,59876778,60292937,62107337,62778367,62858582,63895423,65248176,65970749,66230475,66623176,67314669,69191347,69607669,71227224,71807716,72047794,72199646,72401534,73956337,74597274,74745006,75098726,76023983,76654465,76720258,76997461,78910859,80514647,80783806,81178510,81479273,81646315,82249263,83479808,84170119,84253326,84967832,86546062,86675493,88095202,88728192,89957171,90642847,91324092,91437404,91745478,91867286,92665223,94483086,95595687,97004016,97877034,98888815,98923113,99088635,99417015,99917796,101917014,102880584,104520982,104655475,106417740,108291382,109187823,110633659,111336815,111472757,112015054,112778238,112794414,113349198,113490285,114170791,114211877,116586833,116589918,116650887,116699254,117739885,119830621,119990519,120137547,120915963,120923142,121265388,121721906,121733539,121756348,121835363,122118313,122510575,123041150,123236162,123333549,124689293,124851974,125167769,125469436,125917753,126751062,128138934,129850491,129953089,130225087,130873216,132311294,132446545,132967660,133128194,133445991,134953743,136021028,136796506,137329014,137523512,138142726,139210854,140213679,143285974,143858434,144002486,145438698,146936728,147110088,147830525,148213361,152223959,153697969,154892678,155162079,156230646,156508306,157637517,158510584,160524481,161532966,162446031,164243065,164687858,165964711,167047310,167076334,167451357,167693081,169031388,169750211,170100680,170555666,170733156,170851135,171586611,171892259,171929052,172703934,173921739,174991230,175928496,176627990,176886772,177085312,178081200,178563308,178811195,179276552,179695185,180286594,180408644,180451221,181275883,181646192,183013872,183641736,183653260,184065267,184246710,184325470,184424153,185285482,185378189,185748245,186617893,186941550,187330615,187391511,188109989,188371592,188744726,190266283,190441449,191372879,191967764,194086559,196867711,198029824,198162759,198163633,198198727,198729024,198895790,201612457,202073573,203160651,204162543,204695412,206982602,207735956,208716307,209640991,211628776,211891922,212244512,212277713,212677771,212889457,213077462,213501616,214121378,215998650,217309216,218035829,218240155,218957686,219230503,219323829,221436677,221620438,222239458,222862089,225468515,225576223,225744665,226205336,227095559,227358608,227534795,227697433,229302879,229428726,230065325,230112429,230462387,231440252,231694262,232126330,232281295,232306830,232891677,233652432,234038845,234455368,235449626,235893389,237523513,238124455,238281626,238874765,239665885,240364536,241325073,241769931,241999867,242231759,242825293,243253831,243395406,243869749,245856560,247456545,247472067,247520048,247783143,247884787,248227246,249088414,249377739,252052963,252279060,252736378,253168478,253567612,254871078,255254972,255975673,256474472,256580312,256609547,258241471,260252038,260326333,260473111,260588256,261461228,262474346,262575656,262869169,263683930,264167866,264263165,264976557,265431469,265442785,267082582,268347781,268508486,269087464,269238562,269789379,271081391,273261493,273989398,275037446,275196435,275943765,276312765,276665256,277507844,279528857,280114020,280282923,280486969,281192629,281911365,282251086,283086557,284352621,284713895,285000057,285414744,286172109,286680269,287130389,287897805,287942525,288420574,289122390,290450057,291030416,292087835,292841000,293376554,293403516,293642533,293855243,294486445,294768059,295136600,295797569,296580468,297011964,298704224,298953000,299806577,299988129,300150316,300217490,301060858,301218579,301748601,302152900,302760376,303206929,305129971,305810438,309043647,310237878,311185122,311190299,311256295,311330627,311342134,311588327,311940711,312541146,312860214,313500294,314003137,315434345,317986941,318931028,319146264,319381477,321327715,321388857,321587230,323949358,324548628,324558306,324755084,324969264,325058715,326472369,326499474,326513045,326605402,326630809,326983704,327132151,327232286,328205527,328272570,328675168,328973494,329305320,330153855,330805647,331473217,331982414,332498230,333220918,333342800,333828691,335030237,335142567,335532491,336789368,337280116,338669891,339986825,341014145,342293978,342410888,342830209,343292953,345358610,345893357,346840019,347041409,348270434,348433838,348682967,349253230,349439103,349593834,349595323,350043004,351215759,351309068,351941578,353527013,353991634,354335826,354590680,355266394,356462158,356544642,356786829,357314163,357398864,358001551,358609358,358681185,358976334,359218517,359252129,361073142,363224537,363342230,363864667,363904958,366123358,366292697,367721819,368718170,369109479,369705029,370475834,370807869,372537021,372640511,373429896,374217073,374421665,374690102,374750302,375298689,375342841,375585033,375927825,377447989,378026600,380873856,382100930,382178426,384254765,385371911,385594416,386693497,387933477,388262384,389210581,389360691,389443778,389487753,389615688,390456668,390531945,390598158,391325758,392257604,392866476,393034876,393659412,394692756,395295257,395594336,396652408,398438057,398658877,398984219,399030497,399076090,399500365,399781161,399968091,400243008,400314468,402299981,402542615,402825367,403630548,404376030,404510557,405287199,406364399,406980298,407398212,407581309,408273773,408679001,409092796,409485158,409724156,410285674,411788750,411800087,412015163,412351881,413593195,415280449,415397211,415654462,415840278,416454531,416481264,416716473,416869277,417070334,417173947,418096345,418391457,420037334,420042239,421336379,421356697,421921271,422740213,423123471,423236043,423789507,424666572,425040050,425196905,425722416,426214833,426479126,427564741,427625559,428010006,428760455,428769958,429914367,430116833,431335529,432163757,432295639,434141147,434828325,435562267,436278974,436333913,436355695,437188249,437549831,438206994,438253519,438768144,439493860,440094663,440204904,440216208,440569598,440619866,441567549,441595291,442465427,442573084,443705333,443889839,444257542,445137112,445614666,445945322,446300030,446379613,447048617,447436253,447881890,448827772,451521456,452187382,453365406,454051269,454750073,454818787,455759732,456642950,457403967,457718790,458165742,458582106,459903479,460035875,460220958,460595907,461699145,461730594,461747594,463259144,463496332,463629036,465094923,466119903,466428650,466475392,466865216,468173386,468664082,469082870,469300514,469371825,469606776,469835673,470031971,470414749,470582069,471021860,471098357,471328719,471661933,471815487,472778793,474102988,474504627,474744159,474765820,476183534,476649629,476892737,477139847,477583930,478003217,478954820,479033847,479514494,480145694,481203809,481220584,482379422,483161425,483480684,485921958,486355503,486885736,486985712,488042905,489686792,489702423,490319630,490469302,491762182,491965171,492083888,492760817,492984194,493670570,494364078,496554920,497347415,497413647,497571421,498883418,500088362,501039945,501491065,501566890,503368928,504351591,505285983,505585787,505778627,506318550,506517902,507313733,510238430,510340118,510454520,511841001,512539637,513109953,513289182,513453143,514263280,515513288,515721367,515758444,516326311,516960679,519086018,519104727,519134299,519177002,519792167,520046881,520047467,521162736,521598530,521809144,522738305,523281049,523407552,523918822,524247547,524434563,525116013,525541202,525944307,529215882,530371036,530407245,530421617,530432278,530643920,530919191,532571147,534966949,534988524,535458217,535648140,536613408,537333708,537412927,537843921,538091830,539287095,540465453,541274397,541563971,542329393,542457586,543300027,543326288,543413491,544435757,544662202,545236470,545407300,546437736,548061888,548599903,552790167,553784501,554629222,554690527,554805144,555087543,555906851,556046576,558478765,559353477,560374310,561062930,561428027,562397915,563034655,563524410,563687329,563896606,564691059,565059600,566015012,566565595,567353081,567468210,567538642,567999963,568587784,568927241,570211957,570607264,570894263,571218887,571811125,573371042,573566121,574105508,574390948,575194631,575677841,575688019,575739183,575810274,576976653,576991546,577036890,577960979,578265262,578397174,579607325,579706861,579990268,581498564,581800506,581876598,583385561,583529838,583657006,584162339,584439892,587346564,587682850,588337808,588685655,589223103,589628907,590020383,590236661,590258304,590796956,591671857,591786477,592008366,592611085,592694994,593970975,594187411,594368929,594555721,594715590,595478852,595942987,596713346,597740175,598492906,599090175,600504880,601143559,601187604,601889443,602392381,603666494,603920609,605647363,605689562,605790302,606410166,606496537,606509459,606893304,607700150,608532937,609281070,609336674,610120024,610976832,611335604,612400634,612410927,612592495,612622454,612804490,613290093,613805984,615425684,615532999,615978626,617443830,620376242,620456230,620961338,621519034,622967951,624388883,624454022,624923023,625156332,627419667,628685505,628866118,629001647,629799301,631615273,631619082,631800105,631834627,632111455,632383629,633353259,633551685,634272722,634276400,636264921,637853476,637966132,638153264,639120691,639799948,643365901,643679066,643922764,644664321,645374027,645385178,645660001,645912135,646703690,646840801,647979977,648205187,648725447,648733873,649067716,649535689,649782196,649989120,650063769,650100873,650230344,650710739,650992531,651677722,651714641,652124999,653813770,654397683,655221500,657453034,658717679,658792985,658816151,658816723,659658514,660174788,660359294,660544491,661176110,661994888,662595845,662837723,663291012,663603503,664907689,666383214,667175268,667448447,667545473,667628928,667944885,668050090,668426464,668450360,668988959,669367302,671228532,671702543,672156689,672648259,672831555,672910517,672992998,673643278,674769881,675442253,676668299,677583223,677702497,677711557,678368224,678543812,678994992,679200124,681203141,682599252,683097529,684498016,684806218,684893206,684943978,685122838,686686219,687283700,687708307,688184758,688468191,689001843,689987399,691407949,691928577,692270250,693712967,695147696,695422451,695917417,696849155,697597326,697943774,698373687,698623419,698821309,698881872,702087293,702700124,703177991,705840270,706933914,707046143,707061569,709107849,710305428,710324987,710792365,710877476,710928620,711536692,713149887,713217467,713309119,713614104,714934570,716531435,718238638,718835411,720422024,722054488,723365855,723622524,723937027,725718083,726249982,727088020,727675440,727948948,728910468,729429932,729898200,730271808,730565572,731633390,733097531,733098688,733193651,733439141,733817160,735246961,735256390,735566954,735654348,735891458,736443576,736447563,737701776,738155333,738211090,738684169,739855348,740060347,740322572,740484295,740486937,740770157,741657665,741672115,741894813,743371058,744094184,744175011,744229123,744296783,744976005,745175387,745217294,745745576,746488549,746762623,746850533,749314389,751706887,752688279,753499578,753852949,754437518,754749208,755360787,755507643,756458325,756498265,757366730,757383742,757789944,757918391,758651684,758703591,760032667,760617480,760971267,761347441,761778123,761843683,761936145,762615107,762678929,763115107,767159418,767324538,767356149,767448723,767896721,767904723,768236993,768305720,768854856,770903001,770992808,771394714,771820316,771982382,772025968,772165095,772857822,774423545,775266156,775279317,776646692,776893609,776970771,777294609,778912502,779180593,780309172,781254860,781424423,784429266,785815558,786306377,786616894,787204909,787864152,788746703,788882245,790004965,794804398,795497432,796277330,798254277,798867589,799289002,799733815,800117279,800549937,800766815,803167083,803684222,803820112,803835559,804383686,804416416,804480207,805699348,806410615,807924851,808192342,808407460,808874265,809232597,810209752,810436311,810736693,811584375,812254492,813319402,813365213,813455055,813459217,813479502,813517702,814314534,815587149,815822763,816709816,817565424,818147628,819067469,819336841,819481141,820021778,820347451,820959283,821181989,821836405,824067839,824118049,824155286,824416027,824678640,824709009,825404411,826247413,826639646,826752451,826849245,827342021,827719839,828023495,828064355,828530853,829823834,830663503,830687876,831383817,832882136,833415901,835162977,835612802,835867640,837096895,837436307,838223817,838242201,838681514,838767137,838832545,840716197,842555090,843022394,843122901,843331408,843353471,844963886,845893419,846064624,846906724,847900113,849646580,850295219,850759470,851951229,852010799,852600194,852634621,853724602,854916154,856697870,858205394,858718398,859112168,860177089,860494076,861780792,863385515,864107505,864573663,865166348,865210189,865441338,865467663,865486767,865851804,865878144,866553247,866633036,866703782,867736815,867737217,867787294,867817646,868539652,869766195,869930786,870470675,870757320,874523538,874573281,875972212,876239056,876388482,877225460,877817816,877999425,878747298,878794540,879358004,879380754,879500624,879733925,880458330,880714821,881202967,881366423,882014004,883595824,884697663,886671355,887961527,888624994,889032658,889083549,889430862,889600198,889971988,890093424,890270923,891254500,891678656,892867352,893490212,893569344,893921793,895469813,896021179,897411191,897990901,898128270,898750519,899061226,899700368,900207438,900350846,900572206,901939309,902472477,902855876,903851073,904035984,904863927,905162684,905359610,906144279,907265831,907800420,908218721,908623375,910108645,911517668,912405321,912721813,912788093,912928921,914008568,914296161,914993276,915541357,915829319,916884068,918956014,919527179,919964554,920735069,921260374,921264385,921914145,921962568,922094509,922782580,924169214,924739362,925678038,927503836,927678283,927699627,927980550,928316926,928367959,929539978,930062274,930293041,930935439,932141552,933041581,933193539,933933984,934003217,934433090,934740430,935480838,935992253,936136224,936423477,936843998,936974994,937554886,937786583,939717587,940755762,941034626,941706641,942223885,942307836,942665049,942740671,942880667,942933760,943820261,945573869,945849668,946760388,947213920,947348478,948035919,949082977,949087977,949204164,949660940,950084695,950357207,951325515,952532055,952886018,953619075,956509659,956834346,958479442,959067276,959923502,960335396,960465652,960596087,960655692,960757314,962025208,962151563,962404998,962529333,962673350,963119169,963135632,963269682,963518921,963544621,964260981,964768782,964814376,965177611,965795996,968328252,969644291,970017739,970554752,971994492,973371005,975345153,975681459,976144710,976552773,977180954,977337312,977374544,977718362,978364258,979113369,979206818,980661583,981118238,981429525,981794443,981841197,982620555,982656605,982903388,983397347,983451656,983722534,984814987,984926603,985070994,986601003,986946492,988487079,989301527,989356064,989983450,990480091,990531179,991180634,991804282,991848197,992039401,993287162,994295631,995177827,995246673,996081556,996451675,997027311,997998799,998755848,998757024]
print(s.canCross(stones))